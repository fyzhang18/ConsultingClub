---
title: "Mindprint - Prelim analysis"
author: "Felicia Zhang"
date: '2018-07-10'
output: pdf_document
toc: yes
toc_depth: 2
fontsize: 12pt
fig_height: 5
fig_width: 7
---

```{r setup, include=FALSE, warning=FALSE}
library(ggplot2) 
library(zoo)
library(reshape)
library(plyr)
library(dplyr)
library(scales) 
library(data.table)
library(signal)
library(matrixStats)
library(lme4)
library(arm)
library(broom)
library(tidyr)
library(wesanderson)
library(readxl)    
library(extrafont)

#LOAD MULTIPLE EXCEL SHEETS INTO SEPARATE DFS

#get names of sheets
sheets <- readxl::excel_sheets("~/Documents/Felicia Zhang/Felicia/Princeton/ConsultingClub/Mindprint/ACT Test Data 071018.xlsx")

#load in excel data as 1 big file
lst <- lapply(sheets, function(sheet) 
  readxl::read_excel("~/Documents/Felicia Zhang/Felicia/Princeton/ConsultingClub/Mindprint/ACT Test Data 071018.xlsx", sheet = sheet)
)

#prepare names
names(lst) <- sheets

#turn it into DF
list2env(lst, envir = .GlobalEnv)

#difference between 70C, 72C, Combo v2.4: three different tests based on where we had sufficient student data, noting the one called the Combo is a mixture of SAT and ACT questions.

#0 = incorrect, 1 = correct, 2 = skip

#load in mindprint data
mindprintdata <- read.csv("~/Documents/Felicia Zhang/Felicia/Princeton/ConsultingClub/Mindprint/mindprint_data_export_2018-07-11_10_57_34.csv", header=T)
```

Questions:  
1.	Math tests get progressively difficult throughout the test.  Other tests, difficulty of questions is mostly randomly ordered.  

2.	There is no penalty for guessing on either test so there is always a 25% chance of guessing correctly  

```{r,include=FALSE}


```

```{r, echo=FALSE, warning=FALSE, include=FALSE}
# Format DF
subid <- unique(Sheet2$Subject)

foo <- Sheet2[,2:197]
foo <- stack(foo)

names(foo)[1]<-"Answer"
names(foo)[2]<-"Question"
foo$ID <- 0
foo$ID <- subid

#reorder columns
foo <- foo[,c(3,2,1)]

#add more info
poo <- as.data.frame(t(`Combo v2.4`))
colnames(poo) <- as.character(unlist(poo[1,])) # the first row will be the header
poo = poo[-1, ]   
poo = poo[,1:4]

#combine DFs
foofinal <- foo
foofinal$Test <- poo$Test
foofinal$TestQuestion <- poo$`Test Question`
foofinal$TestSection <- poo$`Test Section`
foofinal$TestSubsection <- poo$`Test Subsection`
```
\newpage

# Compare SAT and ACT performance
## Score
### Overall 
```{r, echo=FALSE, warning=FALSE}

goo <- group_by(foofinal,ID,Test,TestSection) %>%
  summarise(
    correct = length(which(Answer==1)),
    skip = length(which(Answer==2)),
    incorrect = length(which(Answer==0)),
    accuracy = correct/length(unique(Question))
  )

goo2 <- group_by(goo, Test) %>%
  summarise(
    meanacc = mean(accuracy),
    seacc=sd(accuracy, na.rm = TRUE)/sqrt(length(accuracy))
  )

limits <- aes(ymax = meanacc + seacc, ymin=meanacc - seacc)

ggplot(goo2,aes(x=factor(Test),y=meanacc,color=factor(Test),fill=factor(Test)))+
  geom_bar(stat="identity")+
  theme_bw()+
  theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
  labs(x = "Test", y = "Accuracy")+
  theme(plot.title = element_text(face="bold", size=14, hjust=0))+
  theme(axis.title = element_text(face="bold", size=14))+ 
  theme(axis.text.x  = element_text(size=14),axis.text.y  = element_text(size=14))+
  theme(legend.text=element_text(size=14),legend.title=element_text(size=14))+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_y_continuous(limits=c(0,.7),breaks=seq(0,.7,.1))+
  theme(legend.position = "none")+
  theme(text=element_text(family="Times"))+
  scale_fill_manual(values = wes_palette("GrandBudapest2"))+
  scale_color_manual(values = wes_palette("GrandBudapest2"))+
  geom_errorbar(limits, width=0.25, color="black",position=position_dodge(width=0.9))+
  guides(color=FALSE)
```
\newpage

### Each section
```{r, echo=FALSE, warning=FALSE}
# for each section
goo3 <- group_by(goo, Test,TestSection) %>%
  summarise(
    meanacc = mean(accuracy),
    seacc=sd(accuracy, na.rm = TRUE)/sqrt(length(accuracy))
  )

limits <- aes(ymax = meanacc + seacc, ymin=meanacc - seacc)

#facet wrap
ggplot(goo3,aes(x=factor(TestSection),y=meanacc,color=factor(TestSection),fill=factor(TestSection)))+
  geom_bar(stat="identity")+
  theme_bw()+
  theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
  labs(x = "Test section", y = "Accuracy")+
  theme(plot.title = element_text(face="bold", size=14, hjust=0))+
  theme(axis.title = element_text(face="bold", size=14))+ 
  theme(axis.text.x  = element_text(size=14),axis.text.y  = element_text(size=14))+
  theme(legend.text=element_text(size=14),legend.title=element_text(size=14))+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_y_continuous(limits=c(0,1),breaks=seq(0,1,.1))+
  theme(legend.position = "none")+
  theme(text=element_text(family="Times"))+
  scale_fill_manual(values = wes_palette("Moonrise3"))+
  scale_color_manual(values = wes_palette("Moonrise3"))+
  geom_errorbar(limits, width=0.25, color="black",position=position_dodge(width=0.9))+
  guides(color=FALSE)+
  facet_wrap(~Test)+
  theme(strip.text = element_text(size=14))
```
\newpage

### Overlap sections
```{r, echo=FALSE, warning=FALSE}
#compare math and reading
goo4 <- subset(goo3, TestSection == "Math" | TestSection == "Reading")

ggplot(goo4,aes(x=factor(TestSection),y=meanacc,color=factor(Test),fill=factor(Test)))+
  geom_bar(stat="identity",position ="dodge")+
  theme_bw()+
  theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
  labs(x = "Test", y = "Accuracy")+
  theme(plot.title = element_text(face="bold", size=14, hjust=0))+
  theme(axis.title = element_text(face="bold", size=14))+ 
  theme(axis.text.x  = element_text(size=14),axis.text.y  = element_text(size=14))+
  theme(legend.text=element_text(size=14),legend.title=element_text(size=14))+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_y_continuous(limits=c(0,1),breaks=seq(0,1,.1))+
  theme(legend.position = "bottom")+
  theme(text=element_text(family="Times"))+
  scale_fill_manual(name="Test",values = wes_palette("GrandBudapest2"))+
  scale_color_manual(values = wes_palette("GrandBudapest2"))+
  geom_errorbar(limits, width=0.25, color="black",position=position_dodge(width=0.9))+
  guides(color=FALSE)
```
Students might do better on ACT reading than SAT reading.

\newpage

## Number of questions skipped
### Overall 
```{r, echo=FALSE, warning=FALSE}
#how many questions did they skip
goo5 <- group_by(goo, Test) %>%
  summarise(
    meanskip = mean(skip),
    seskip=sd(skip, na.rm = TRUE)/sqrt(length(skip))
  )

limits <- aes(ymax = meanskip + seskip, ymin=meanskip - seskip)

ggplot(goo5,aes(x=factor(Test),y=meanskip,color=factor(Test),fill=factor(Test)))+
  geom_bar(stat="identity")+
  theme_bw()+
  theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
  labs(x = "Test", y = "Percent of questions skipped")+
  theme(plot.title = element_text(face="bold", size=14, hjust=0))+
  theme(axis.title = element_text(face="bold", size=14))+ 
  theme(axis.text.x  = element_text(size=14),axis.text.y  = element_text(size=14))+
  theme(legend.text=element_text(size=14),legend.title=element_text(size=14))+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_y_continuous(limits=c(0,.6),breaks=seq(0,.6,.1))+
  theme(legend.position = "none")+
  theme(text=element_text(family="Times"))+
  scale_fill_manual(values = wes_palette("GrandBudapest2"))+
  scale_color_manual(values = wes_palette("GrandBudapest2"))+
  geom_errorbar(limits, width=0.25, color="black",position=position_dodge(width=0.9))+
  guides(color=FALSE)
```

### Each section 
```{r, echo=FALSE, warning=FALSE}
# 
goo3 <- group_by(goo, Test, TestSection) %>%
  summarise(
    meanskip = mean(skip),
    seskip=sd(skip, na.rm = TRUE)/sqrt(length(skip))
  )

limits <- aes(ymax = meanskip + seskip, ymin=meanskip - seskip)

#facet wrap
ggplot(goo3,aes(x=factor(TestSection),y=meanskip,color=factor(TestSection),fill=factor(TestSection)))+
  geom_bar(stat="identity")+
  theme_bw()+
  theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
  labs(x = "Test section", y = "Percent of questions skipped")+
  theme(plot.title = element_text(face="bold", size=14, hjust=0))+
  theme(axis.title = element_text(face="bold", size=14))+ 
  theme(axis.text.x  = element_text(size=14),axis.text.y  = element_text(size=14))+
  theme(legend.text=element_text(size=14),legend.title=element_text(size=14))+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_y_continuous(limits=c(0,1),breaks=seq(0,1,.1))+
  theme(legend.position = "none")+
  theme(text=element_text(family="Times"))+
  scale_fill_manual(values = wes_palette("Moonrise3"))+
  scale_color_manual(values = wes_palette("Moonrise3"))+
  geom_errorbar(limits, width=0.25, color="black",position=position_dodge(width=0.9))+
  guides(color=FALSE)+
  facet_wrap(~Test)+
  theme(strip.text = element_text(size=14))
```

### Overlap sections
```{r, echo=FALSE, warning=FALSE}
#compare math and reading
goo4 <- subset(goo3, TestSection == "Math" | TestSection == "Reading")

ggplot(goo4,aes(x=factor(TestSection),y=meanskip,color=factor(Test),fill=factor(Test)))+
  geom_bar(stat="identity",position ="dodge")+
  theme_bw()+
  theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
  labs(x = "Test", y = "Percent of questions skipped")+
  theme(plot.title = element_text(face="bold", size=14, hjust=0))+
  theme(axis.title = element_text(face="bold", size=14))+ 
  theme(axis.text.x  = element_text(size=14),axis.text.y  = element_text(size=14))+
  theme(legend.text=element_text(size=14),legend.title=element_text(size=14))+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_y_continuous(limits=c(0,1),breaks=seq(0,1,.1))+
  theme(legend.position = "bottom")+
  theme(text=element_text(family="Times"))+
  scale_fill_manual(name="Test",values = wes_palette("GrandBudapest2"))+
  scale_color_manual(values = wes_palette("GrandBudapest2"))+
  geom_errorbar(limits, width=0.25, color="black",position=position_dodge(width=0.9))+
  guides(color=FALSE)
```

## Correlations
### Overall 
```{r, echo=FALSE, warning=FALSE}
goo <- group_by(foofinal,ID,Test,TestSection) %>%
  summarise(
    correct = length(which(Answer==1)),
    skip = length(which(Answer==2)),
    incorrect = length(which(Answer==0)),
    accuracy = correct/length(unique(Question))
  )

goo2 <- group_by(goo, ID) %>%
  summarise(
    SATaccuracy = mean(accuracy[Test=="SAT"]),
    ACTaccuracy = mean(accuracy[Test=="ACT"])
  )

ggplot(goo2,aes(x=SATaccuracy,y=ACTaccuracy))+
  geom_point()+
  theme_bw()+
  theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
  labs(x = "SAT accuracy", y = "ACT accuracy")+
  theme(plot.title = element_text(face="bold", size=14, hjust=0))+
  theme(axis.title = element_text(face="bold", size=14))+ 
  theme(axis.text.x  = element_text(size=14),axis.text.y  = element_text(size=14))+
  theme(legend.text=element_text(size=14),legend.title=element_text(size=14))+
  theme(plot.title = element_text(hjust = 0.5))+
  theme(text=element_text(family="Times"))+
  scale_y_continuous(labels=percent,limits=c(0,1),breaks=seq(0,1,.1))+
  scale_x_continuous(labels=percent,limits=c(0,1),breaks=seq(0,1,.1))+
  stat_smooth(method="lm", se = FALSE)
```

### Overlap sections
```{r, echo=FALSE, warning=FALSE}
goo2 <- group_by(goo, ID) %>%
  summarise(
    SATMath = mean(accuracy[Test=="SAT" & TestSection=="Math"]),
    ACTMath = mean(accuracy[Test=="ACT" & TestSection=="Math"]),
    SATReading = mean(accuracy[Test=="SAT" & TestSection=="Reading"]),
    ACTReading = mean(accuracy[Test=="ACT" & TestSection=="Reading"])    
  )

ggplot(goo2,aes(x=SATMath,y=ACTMath))+
  geom_point()+
  theme_bw()+
  theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
  labs(x = "SAT math accuracy", y = "ACT math accuracy")+
  theme(plot.title = element_text(face="bold", size=14, hjust=0))+
  theme(axis.title = element_text(face="bold", size=14))+ 
  theme(axis.text.x  = element_text(size=14),axis.text.y  = element_text(size=14))+
  theme(legend.text=element_text(size=14),legend.title=element_text(size=14))+
  theme(plot.title = element_text(hjust = 0.5))+
  theme(text=element_text(family="Times"))+
  scale_y_continuous(labels=percent,limits=c(0,1),breaks=seq(0,1,.1))+
  scale_x_continuous(labels=percent,limits=c(0,1),breaks=seq(0,1,.1))+
  stat_smooth(method="lm", se = FALSE)

ggplot(goo2,aes(x=SATReading,y=ACTReading))+
  geom_point()+
  theme_bw()+
  theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
  labs(x = "SAT reading accuracy", y = "ACT reading accuracy")+
  theme(plot.title = element_text(face="bold", size=14, hjust=0))+
  theme(axis.title = element_text(face="bold", size=14))+ 
  theme(axis.text.x  = element_text(size=14),axis.text.y  = element_text(size=14))+
  theme(legend.text=element_text(size=14),legend.title=element_text(size=14))+
  theme(plot.title = element_text(hjust = 0.5))+
  theme(text=element_text(family="Times"))+
  scale_y_continuous(labels=percent,limits=c(0,1),breaks=seq(0,1,.1))+
  scale_x_continuous(labels=percent,limits=c(0,1),breaks=seq(0,1,.1))+
  stat_smooth(method="lm", se = FALSE)
```
\newpage 

# Does mindprint data predict SAT/ACT performance?

Hypotheses:  
1.	Students who have high expected in the respective reasoning skill have the ability to get all questions right (i.e. no difference if you’re high expected or a strength); would look at discrepancy with flexible thinking for understanding performance on the most challenging questions (e.g. hardest 25%). In other words, if you have low expected flexible thinking and strong abstract reasoning you might get hardest 25% incorrect on Math  

2.	Students who have medium expected in the respective reasoning skill would get easy to medium difficulty questions correct but would struggle on the higher difficulty level questions (e.g. hardest 25%)  

3.	Relative difficulties with memory could impact performance on the easy or medium difficulty level questions. i.e. strong verbal reasoning but low expected verbal or visual memory might have errors on usage mechanics/grammar/punctuation  

4.	Difficulties with attention/working memory/processing speed would interfere with expected results based on reasoning and memory explanations  

## Hypothesis: Students who have high expected in the respective reasoning skill have the ability to get all questions right
### Verbal reasoning (english, reading)
```{r, echo=FALSE, warning=FALSE}
goo <- group_by(foofinal,ID,Test,TestSection) %>%
  summarise(
    correct = length(which(Answer==1)),
    skip = length(which(Answer==2)),
    incorrect = length(which(Answer==0)),
    accuracy = correct/length(unique(Question))
  )

goo$TestSection2[goo$Test=="SAT" & goo$TestSection=="Math"] <- "SAT Math"
goo$TestSection2[goo$Test=="ACT" & goo$TestSection=="Math"] <- "ACT Math"
goo$TestSection2[goo$Test=="SAT" & goo$TestSection=="Reading"] <- "SAT Reading"
goo$TestSection2[goo$Test=="ACT" & goo$TestSection=="Reading"] <- "ACT Reading"
goo$TestSection2[goo$TestSection=="English"] <- "ACT English"
goo$TestSection2[goo$TestSection=="Science"] <- "ACT Science"
goo$TestSection2[goo$TestSection=="Writing"] <- "SAT Writing"

# english and reading
goo2 <- goo[grep("English|Reading", goo$TestSection2),]
names(goo2)[1]<-"student_id"

#subset mindprint data to same subjects
subID <- unique(goo$ID)
boo <- subset(mindprintdata, subset = student_id %in% subID)

#merge
boofinal <- merge(goo2, boo)

#plot
ggplot(boofinal,aes(x=LAN_Az,y=accuracy,color=factor(TestSection2),fill=factor(TestSection2)))+
  geom_point()+
  theme_bw()+
  theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
  labs(x = "Normed accuracy score for verbal reasoning", y = "Accuracy")+
  theme(plot.title = element_text(face="bold", size=14, hjust=0))+
  theme(axis.title = element_text(face="bold", size=14))+ 
  theme(axis.text.x  = element_text(size=14),axis.text.y  = element_text(size=14))+
  theme(legend.text=element_text(size=14),legend.title=element_text(size=14))+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_y_continuous(labels=percent,limits=c(0,1),breaks=seq(0,1,.1))+
  facet_wrap(~TestSection2)+
  theme(legend.position = "none")+
  theme(text=element_text(family="Times"))+
  scale_fill_manual(values = wes_palette("Darjeeling"))+
  scale_color_manual(values = wes_palette("Darjeeling"))+
  guides(color=FALSE)+
  stat_smooth(method="lm", se = FALSE, size = 1.5)+
  theme(strip.text = element_text(size=14))
```
\newpage

### Abstract reasoning (math, science) 
```{r, echo=FALSE, warning=FALSE}
goo <- group_by(foofinal,ID,Test,TestSection) %>%
  summarise(
    correct = length(which(Answer==1)),
    skip = length(which(Answer==2)),
    incorrect = length(which(Answer==0)),
    accuracy = correct/length(unique(Question))
  )

goo$TestSection2[goo$Test=="SAT" & goo$TestSection=="Math"] <- "SAT Math"
goo$TestSection2[goo$Test=="ACT" & goo$TestSection=="Math"] <- "ACT Math"
goo$TestSection2[goo$Test=="SAT" & goo$TestSection=="Reading"] <- "SAT Reading"
goo$TestSection2[goo$Test=="ACT" & goo$TestSection=="Reading"] <- "ACT Reading"
goo$TestSection2[goo$TestSection=="English"] <- "ACT English"
goo$TestSection2[goo$TestSection=="Science"] <- "ACT Science"
goo$TestSection2[goo$TestSection=="Writing"] <- "SAT Writing"

# math and science
goo2 <- goo[grep("Math|Science", goo$TestSection2),]
names(goo2)[1]<-"student_id"

#subset mindprint data to same subjects
subID <- unique(goo$ID)
boo <- subset(mindprintdata, subset = student_id %in% subID)

#merge
boofinal <- merge(goo2, boo)

#plot
ggplot(boofinal,aes(x=NVR_Az,y=accuracy,color=factor(TestSection2),fill=factor(TestSection2)))+
  geom_point()+
  theme_bw()+
  theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
  labs(x = "Normed accuracy score for abstract reasoning", y = "Accuracy")+
  theme(plot.title = element_text(face="bold", size=14, hjust=0))+
  theme(axis.title = element_text(face="bold", size=14))+ 
  theme(axis.text.x  = element_text(size=14),axis.text.y  = element_text(size=14))+
  theme(legend.text=element_text(size=14),legend.title=element_text(size=14))+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_y_continuous(labels=percent,limits=c(0,1),breaks=seq(0,1,.1))+
  facet_wrap(~TestSection2)+
  theme(legend.position = "none")+
  theme(text=element_text(family="Times"))+
  scale_fill_manual(values = wes_palette("Darjeeling"))+
  scale_color_manual(values = wes_palette("Darjeeling"))+
  guides(color=FALSE)+
  stat_smooth(method="lm", se = FALSE, size = 1.5)+
  theme(strip.text = element_text(size=14))
```
\newpage

### Verbal memory (english, reading)
```{r, echo=FALSE, warning=FALSE}
goo <- group_by(foofinal,ID,Test,TestSection) %>%
  summarise(
    correct = length(which(Answer==1)),
    skip = length(which(Answer==2)),
    incorrect = length(which(Answer==0)),
    accuracy = correct/length(unique(Question))
  )

goo$TestSection2[goo$Test=="SAT" & goo$TestSection=="Math"] <- "SAT Math"
goo$TestSection2[goo$Test=="ACT" & goo$TestSection=="Math"] <- "ACT Math"
goo$TestSection2[goo$Test=="SAT" & goo$TestSection=="Reading"] <- "SAT Reading"
goo$TestSection2[goo$Test=="ACT" & goo$TestSection=="Reading"] <- "ACT Reading"
goo$TestSection2[goo$TestSection=="English"] <- "ACT English"
goo$TestSection2[goo$TestSection=="Science"] <- "ACT Science"
goo$TestSection2[goo$TestSection=="Writing"] <- "SAT Writing"

# english and reading
goo2 <- goo[grep("English|Reading", goo$TestSection2),]
names(goo2)[1]<-"student_id"

#subset mindprint data to same subjects
subID <- unique(goo$ID)
boo <- subset(mindprintdata, subset = student_id %in% subID)

#merge
boofinal <- merge(goo2, boo)

#plot
ggplot(boofinal,aes(x=VMEM_Az,y=accuracy,color=factor(TestSection2),fill=factor(TestSection2)))+
  geom_point()+
  theme_bw()+
  theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
  labs(x = "Normed accuracy score for verbal memory", y = "Accuracy")+
  theme(plot.title = element_text(face="bold", size=14, hjust=0))+
  theme(axis.title = element_text(face="bold", size=14))+ 
  theme(axis.text.x  = element_text(size=14),axis.text.y  = element_text(size=14))+
  theme(legend.text=element_text(size=14),legend.title=element_text(size=14))+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_y_continuous(labels=percent,limits=c(0,1),breaks=seq(0,1,.1))+
  facet_wrap(~TestSection2)+
  theme(legend.position = "none")+
  theme(text=element_text(family="Times"))+
  scale_fill_manual(values = wes_palette("Darjeeling"))+
  scale_color_manual(values = wes_palette("Darjeeling"))+
  guides(color=FALSE)+
  stat_smooth(method="lm", se = FALSE, size = 1.5)+
  theme(strip.text = element_text(size=14))
```
\newpage

### Working memory (reading, math, science)
```{r, echo=FALSE, warning=FALSE}
goo <- group_by(foofinal,ID,Test,TestSection) %>%
  summarise(
    correct = length(which(Answer==1)),
    skip = length(which(Answer==2)),
    incorrect = length(which(Answer==0)),
    accuracy = correct/length(unique(Question))
  )

goo$TestSection2[goo$Test=="SAT" & goo$TestSection=="Math"] <- "SAT Math"
goo$TestSection2[goo$Test=="ACT" & goo$TestSection=="Math"] <- "ACT Math"
goo$TestSection2[goo$Test=="SAT" & goo$TestSection=="Reading"] <- "SAT Reading"
goo$TestSection2[goo$Test=="ACT" & goo$TestSection=="Reading"] <- "ACT Reading"
goo$TestSection2[goo$TestSection=="English"] <- "ACT English"
goo$TestSection2[goo$TestSection=="Science"] <- "ACT Science"
goo$TestSection2[goo$TestSection=="Writing"] <- "SAT Writing"

# math, science, reading
goo2 <- goo[grep("Math|Science|Reading", goo$TestSection2),]
names(goo2)[1]<-"student_id"

#subset mindprint data to same subjects
subID <- unique(goo$ID)
boo <- subset(mindprintdata, subset = student_id %in% subID)

#merge
boofinal <- merge(goo2, boo)

#plot
ggplot(boofinal,aes(x=WM_Az,y=accuracy,color=factor(TestSection2),fill=factor(TestSection2)))+
  geom_point()+
  theme_bw()+
  theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
  labs(x = "Normed accuracy score for working memory", y = "Accuracy")+
  theme(plot.title = element_text(face="bold", size=14, hjust=0))+
  theme(axis.title = element_text(face="bold", size=14))+ 
  theme(axis.text.x  = element_text(size=14),axis.text.y  = element_text(size=14))+
  theme(legend.text=element_text(size=14),legend.title=element_text(size=14))+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_y_continuous(labels=percent,limits=c(0,1),breaks=seq(0,1,.1))+
  facet_wrap(~TestSection2)+
  theme(strip.text = element_text(size=14))+
  theme(legend.position = "none")+
  theme(text=element_text(family="Times"))+
  scale_fill_manual(values = wes_palette("Darjeeling"))+
  scale_color_manual(values = wes_palette("Darjeeling"))+
  guides(color=FALSE)+
  stat_smooth(method="lm", se = FALSE, size = 1.5)
  
```
\newpage

### Visual memory (math)
```{r, echo=FALSE, warning=FALSE}
goo <- group_by(foofinal,ID,Test,TestSection) %>%
  summarise(
    correct = length(which(Answer==1)),
    skip = length(which(Answer==2)),
    incorrect = length(which(Answer==0)),
    accuracy = correct/length(unique(Question))
  )

goo$TestSection2[goo$Test=="SAT" & goo$TestSection=="Math"] <- "SAT Math"
goo$TestSection2[goo$Test=="ACT" & goo$TestSection=="Math"] <- "ACT Math"
goo$TestSection2[goo$Test=="SAT" & goo$TestSection=="Reading"] <- "SAT Reading"
goo$TestSection2[goo$Test=="ACT" & goo$TestSection=="Reading"] <- "ACT Reading"
goo$TestSection2[goo$TestSection=="English"] <- "ACT English"
goo$TestSection2[goo$TestSection=="Science"] <- "ACT Science"
goo$TestSection2[goo$TestSection=="Writing"] <- "SAT Writing"

# english and reading
goo2 <- goo[grep("Math", goo$TestSection2),]
names(goo2)[1]<-"student_id"

#subset mindprint data to same subjects
subID <- unique(goo$ID)
boo <- subset(mindprintdata, subset = student_id %in% subID)

#merge
boofinal <- merge(goo2, boo)

#plot
ggplot(boofinal,aes(x=SMEM_Az,y=accuracy,color=factor(TestSection2),fill=factor(TestSection2)))+
  geom_point()+
  theme_bw()+
  theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
  labs(x = "Normed accuracy score for visual memory", y = "Accuracy")+
  theme(plot.title = element_text(face="bold", size=14, hjust=0))+
  theme(axis.title = element_text(face="bold", size=14))+ 
  theme(axis.text.x  = element_text(size=14),axis.text.y  = element_text(size=14))+
  theme(legend.text=element_text(size=14),legend.title=element_text(size=14))+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_y_continuous(labels=percent,limits=c(0,1),breaks=seq(0,1,.1))+
  theme(legend.position = "none")+
  theme(text=element_text(family="Times"))+
  scale_fill_manual(values = wes_palette("Darjeeling"))+
  scale_color_manual(values = wes_palette("Darjeeling"))+
  guides(color=FALSE)+
  stat_smooth(method="lm", se = FALSE, size = 1.5)+
  facet_wrap(~TestSection2)+
  theme(strip.text = element_text(size=14))
```
\newpage

### Spatial perception (math, science)
```{r, echo=FALSE, warning=FALSE}
goo <- group_by(foofinal,ID,Test,TestSection) %>%
  summarise(
    correct = length(which(Answer==1)),
    skip = length(which(Answer==2)),
    incorrect = length(which(Answer==0)),
    accuracy = correct/length(unique(Question))
  )

goo$TestSection2[goo$Test=="SAT" & goo$TestSection=="Math"] <- "SAT Math"
goo$TestSection2[goo$Test=="ACT" & goo$TestSection=="Math"] <- "ACT Math"
goo$TestSection2[goo$Test=="SAT" & goo$TestSection=="Reading"] <- "SAT Reading"
goo$TestSection2[goo$Test=="ACT" & goo$TestSection=="Reading"] <- "ACT Reading"
goo$TestSection2[goo$TestSection=="English"] <- "ACT English"
goo$TestSection2[goo$TestSection=="Science"] <- "ACT Science"
goo$TestSection2[goo$TestSection=="Writing"] <- "SAT Writing"

# math and science
goo2 <- goo[grep("Math|Science", goo$TestSection2),]
names(goo2)[1]<-"student_id"

#subset mindprint data to same subjects
subID <- unique(goo$ID)
boo <- subset(mindprintdata, subset = student_id %in% subID)

#merge
boofinal <- merge(goo2, boo)

#plot
ggplot(boofinal,aes(x=SPA_Az,y=accuracy,color=factor(TestSection2),fill=factor(TestSection2)))+
  geom_point()+
  theme_bw()+
  theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+
  labs(x = "Normed accuracy score for spatial perception", y = "Accuracy")+
  theme(plot.title = element_text(face="bold", size=14, hjust=0))+
  theme(axis.title = element_text(face="bold", size=14))+ 
  theme(axis.text.x  = element_text(size=14),axis.text.y  = element_text(size=14))+
  theme(legend.text=element_text(size=14),legend.title=element_text(size=14))+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_y_continuous(labels=percent,limits=c(0,1),breaks=seq(0,1,.1))+
  facet_wrap(~TestSection2)+
  theme(legend.position = "none")+
  theme(text=element_text(family="Times"))+
  scale_fill_manual(values = wes_palette("Darjeeling"))+
  scale_color_manual(values = wes_palette("Darjeeling"))+
  guides(color=FALSE)+
  stat_smooth(method="lm", se = FALSE, size = 1.5)+
  theme(strip.text = element_text(size=14))
```
\newpage

##	Difficulties with attention/working memory/processing speed would interfere with expected results based on reasoning and memory explanations  

```{r, echo=FALSE, warning=FALSE}
#Run linear models including attention, wm, processing speed
```
